# –í–û–ü–†–û–°–´ –ò –û–¢–í–ï–¢–´ –î–õ–Ø –ó–ê–©–ò–¢–´ –ü–†–û–ï–ö–¢–ê

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ C++, –∞ –Ω–µ Rust/Go/Python?

**–û—Ç–≤–µ—Ç:**
> "C++ –≤—ã–±—Ä–∞–Ω –ø–æ —Ç—Ä–µ–º –ø—Ä–∏—á–∏–Ω–∞–º:
> 
> 1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º API –±–µ–∑ overhead garbage collector. –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –≥–¥–µ –≤–∞–∂–Ω–∞ –∫–∞–∂–¥–∞—è –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥–∞.
> 
> 2. **–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞** ‚Äî –∑—Ä–µ–ª—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Netfilter (libnetfilter_queue). –í Rust —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –∑–∞–¥–∞—á –µ—â–µ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è.
> 
> 3. **–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–∞–º—è—Ç—å—é** ‚Äî —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM –¥–æ 512 –ú–ë. Go —Å garbage collector –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –º–∏–Ω–∏–º—É–º 1-2 –ì–ë.
> 
> Python —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª—Å—è –¥–ª—è –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞, –Ω–æ —Å–∫–æ—Ä–æ—Å—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ ‚Äî –≤ —Ç–µ—Å—Ç–∞—Ö Python –±—ã–ª –≤ 50-100 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ C++."

---

### 2. –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã? –ú–æ–∂–Ω–æ –ª–∏ –æ–±–æ–π—Ç–∏ IPS —á–µ—Ä–µ–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é?

**–û—Ç–≤–µ—Ç:**
> "Netfilter –≤ —è–¥—Ä–µ Linux –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∞—Å—Å–µ–º–±–ª–∏—Ä—É–µ—Ç IP-—Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –≤ NFQUEUE. –ú—ã –ø–æ–ª—É—á–∞–µ–º —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –≤ user space, –ø–æ—ç—Ç–æ–º—É –∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é payload –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞.
> 
> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ —ç—Ç–æ:
> ```bash
> # –û—Ç–ø—Ä–∞–≤–∫–∞ SQL injection –ø–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º
> hping3 -S -d 100 --file sql_payload.txt --frag localhost
> ```
> –†–µ–∑—É–ª—å—Ç–∞—Ç: IPS —É—Å–ø–µ—à–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª ‚Äî payload –±—ã–ª —Å–æ–±—Ä–∞–Ω —è–¥—Ä–æ–º –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º.
> 
> **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ:** TCP stream reassembly –¥–ª—è –º–Ω–æ–≥–æ–ø–∞–∫–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (stateful inspection), —ç—Ç–æ –≤ –ø–ª–∞–Ω–∞—Ö –≤–µ—Ä—Å–∏–∏ 2.0."

---

### 3. –ß—Ç–æ –Ω–∞—Å—á–µ—Ç false positives? –ö–∞–∫ –≤—ã —Å –Ω–∏–º–∏ –±–æ—Ä–µ—Ç–µ—Å—å?

**–û—Ç–≤–µ—Ç:**
> "–í —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤—ã—è–≤–∏–ª–∏ 14 false positives –∏–∑ 2 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –ø–∞–∫–µ—Ç–æ–≤ (0.0007%). –ö–∞—Ç–µ–≥–æ—Ä–∏–∏:
> 
> 1. **–õ–µ–≥–∏—Ç–∏–º–Ω—ã–π —Ç–µ–∫—Å—Ç —Å SQL keywords** ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, 'Please select your option'
>    - **–†–µ—à–µ–Ω–∏–µ:** –£–ª—É—á—à–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º: `'(select .* from) OR (union .* select)'` –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ `'select OR union'`
> 
> 2. **–ß–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç CDN/Bot'–æ–≤** ‚Äî Google Bot –¥–µ–ª–∞–ª 15 req/s
>    - **–†–µ—à–µ–Ω–∏–µ:** Whitelist –¥–ª—è –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö User-Agent –∏ IP-–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ CDN
> 
> 3. **Dev/—Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞** ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É—é—Ç SQL-–∑–∞–ø—Ä–æ—Å—ã
>    - **–†–µ—à–µ–Ω–∏–µ:** –†–µ–∂–∏–º 'alert-only' –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ (–Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å)
> 
> **–ú–µ—Ç—Ä–∏–∫–∞:** F1-score = 0.97, —á—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç–ª–∏—á–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –¥–ª—è IPS (Snort –≤ —Å—Ä–µ–¥–Ω–µ–º 0.92-0.95)."

---

### 4. –ö–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –≤—ã—Å–æ–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É? –ß—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç throughput?

**–û—Ç–≤–µ—Ç:**
> "–¢–µ–∫—É—â–∏–π throughput: 920 –ú–±–∏—Ç/—Å (UDP). –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã:
> 
> 1. **Single-threaded –æ–±—Ä–∞–±–æ—Ç–∫–∞** ‚Äî –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –ø—Ä–æ—Ü–µ—Å—Å–∏—Ç –≤—Å–µ –ø–∞–∫–µ—Ç—ã –∏–∑ NFQUEUE
>    - **–†–µ—à–µ–Ω–∏–µ:** Thread pool ‚Äî –∫–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–≤–æ—é –ø–æ–¥–æ—á–µ—Ä–µ–¥—å
>    - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 2-4x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput
> 
> 2. **User space processing** ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ kernel space
>    - **–†–µ—à–µ–Ω–∏–µ:** XDP (eXpress Data Path) ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥—Ä–∞–π–≤–µ—Ä–∞ —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã
>    - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 10x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput (–¥–æ 10 –ì–±–∏—Ç/—Å)
> 
> 3. **Content inspection** ‚Äî –ø–æ–∏—Å–∫ –ø–æ–¥—Å—Ç—Ä–æ–∫ –≤ payload (—Å–∞–º–∞—è –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
>    - **–†–µ—à–µ–Ω–∏–µ:** Aho-Corasick –∞–ª–≥–æ—Ä–∏—Ç–º –≤–º–µ—Å—Ç–æ naive search
>    - **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** 5x —É—Å–∫–æ—Ä–µ–Ω–∏–µ string matching
> 
> –î–ª—è SMB-—Å–µ–≥–º–µ–Ω—Ç–∞ (99% —Å–µ—Ç–µ–π <1 –ì–±–∏—Ç/—Å) —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞. –î–ª—è enterprise ‚Äî –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è."

---

### 5. –ú–æ–∂–Ω–æ –ª–∏ –æ–±–æ–π—Ç–∏ IPS —á–µ—Ä–µ–∑ SSL/TLS —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ?

**–û—Ç–≤–µ—Ç:**
> "–î–∞, —ç—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ. –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ content inspection —Ä–∞–±–æ—Ç–∞–µ—Ç —Å plaintext payload.
> 
> **–†–µ—à–µ–Ω–∏—è:**
> 
> 1. **SSL/TLS Interception (Man-in-the-Middle —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º)**
>    - IPS –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ proxy: —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç ‚Üí –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç ‚Üí –∑–∞–Ω–æ–≤–æ —à–∏—Ñ—Ä—É–µ—Ç
>    - –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ CA-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ –∫–ª–∏–µ–Ω—Ç—ã
>    - **–ú–∏–Ω—É—Å:** privacy concerns, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
> 
> 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
>    - –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –≤ reverse proxy (nginx, Apache)
>    - IPS –ø–æ–ª—É—á–∞–µ—Ç plaintext —á–µ—Ä–µ–∑ UNIX socket
>    - **–ü–ª—é—Å:** –Ω–µ—Ç MITM, **–ú–∏–Ω—É—Å:** —Ç–æ–ª—å–∫–æ –¥–ª—è HTTP/HTTPS
> 
> 3. **Heuristic analysis**
>    - –ê–Ω–∞–ª–∏–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö TLS (SNI, certificate chain, handshake patterns)
>    - –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
>    - **–ü–ª—é—Å:** privacy-friendly, **–ú–∏–Ω—É—Å:** –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
> 
> **–ü–ª–∞–Ω:** SSL inspection –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ—Ä—Å–∏–∏ 2.0 —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å nginx."

---

### 6. –ü–æ—á–µ–º—É JSON –¥–ª—è –ø—Ä–∞–≤–∏–ª, –∞ –Ω–µ YAML –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π DSL?

**–û—Ç–≤–µ—Ç:**
> "–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏ 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞:
> 
> | –ö—Ä–∏—Ç–µ—Ä–∏–π | JSON | YAML | Custom DSL (Snort-like) |
> |----------|------|------|-------------------------|
> | Parsing speed | –ë—ã—Å—Ç—Ä–æ | –ú–µ–¥–ª–µ–Ω–Ω–æ | –°—Ä–µ–¥–Ω–µ |
> | –í–∞–ª–∏–¥–∞—Ü–∏—è | Strict schema | –ì–∏–±–∫–∞—è, –Ω–æ loose | –¢—Ä–µ–±—É–µ—Ç –ø–∞—Ä—Å–µ—Ä–∞ |
> | –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –í—ã—Å–æ–∫–∞—è (–µ—Å–ª–∏ –ø—Ä–∏–≤—ã–∫) |
> | Tooling | –û—Ç–ª–∏—á–Ω–∞—è | –•–æ—Ä–æ—à–∞—è | –°–ª–∞–±–∞—è (custom) |
> | –†–∞–∑–º–µ—Ä | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π | Verbose | –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π |
> 
> **–†–µ—à–µ–Ω–∏–µ:** JSON –¥–ª—è –ø—Ä–∞–≤–∏–ª (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å + strict schema) + YAML –¥–ª—è –æ–±—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—á–∏—Ç–∞–µ–º–æ—Å—Ç—å).
> 
> **–ü—Ä–∏–º–µ—Ä:**
> ```json
> // rules.json ‚Äî —Å—Ç—Ä–æ–≥–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –±—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥
> {"rule_id": 1001, "src_ip": "any", "action": "drop"}
> ```
> 
> ```yaml
> # config.yml ‚Äî —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
> admin:
>   username: admin
>   password: secret
> ```
> 
> Custom DSL (–∫–∞–∫ —É Snort) —Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞, —á—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É."

---

### 7. –ö–∞–∫ IPS —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ –≤—ã—à–µ IP (HTTP, DNS, SSH)?

**–û—Ç–≤–µ—Ç:**
> "–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ L3-L4 (IP, TCP, UDP). –î–ª—è application-layer –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è content inspection ‚Äî –ø–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫ –≤ payload.
> 
> **–¢–µ–∫—É—â–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
> 
> - **HTTP** ‚Äî –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ keywords –≤ HTTP-–∑–∞–ø—Ä–æ—Å–∞—Ö
>   - SQL injection: `'select OR union'` –≤ query parameters
>   - Command injection: `'system OR exec'` –≤ POST data
>   - **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** –Ω–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
> 
> - **DNS** ‚Äî –Ω–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
>   - –ú–æ–∂–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ IP DNS-—Å–µ—Ä–≤–µ—Ä–∞
>   - **–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:** DNS tunneling –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
> 
> - **SSH** ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ—Ä—Ç—É (22)
>   - **–ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:** SSH brute-force –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
> 
> **–ü–ª–∞–Ω –¥–ª—è –≤–µ—Ä—Å–∏–∏ 2.0:**
> 
> 1. **HTTP Parser**
>    - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URI, headers, cookies
>    - –ü—Ä–∞–≤–∏–ª–∞ —Ç–∏–ø–∞: `http.uri contains '/admin'`
> 
> 2. **DNS Parser**
>    - –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DNS tunneling (–∞–Ω–æ–º–∞–ª—å–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ subdomains)
>    - Blacklist –¥–æ–º–µ–Ω–æ–≤ (malware C2)
> 
> 3. **SSH Protection**
>    - Brute-force –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (N –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ ‚Üí ban)
>    - Honeypot —Ä–µ–∂–∏–º (fake SSH –Ω–∞ 2222)
> 
> –î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π L7-–∑–∞—â–∏—Ç—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Suricata (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IPS –∫–∞–∫ pre-filter, Suricata ‚Äî –¥–ª—è deep inspection)."

---

## –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### 8. –ß–µ–º –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –ª—É—á—à–µ –≥–æ—Ç–æ–≤—ã—Ö (Snort, Suricata)?

**–û—Ç–≤–µ—Ç:**
> "–ù–µ '–ª—É—á—à–µ', –∞ '–æ–ø—Ç–∏–º–∞–ª—å–Ω–µ–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤'. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:
> 
> | –ö—Ä–∏—Ç–µ—Ä–∏–π | –ù–∞—à IPS | Snort | Suricata |
> |----------|---------|-------|----------|
> | **–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è** | SMB, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, IoT | Enterprise | Enterprise, ISP |
> | **–°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** | –ù–∏–∑–∫–∞—è (JSON) | –í—ã—Å–æ–∫–∞—è (DSL) | –í—ã—Å–æ–∫–∞—è (YAML + –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å) |
> | **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è RAM** | 512 –ú–ë | 1 –ì–ë | 2-4 –ì–ë |
> | **Throughput** | 920 –ú–±–∏—Ç/—Å | 800 –ú–±–∏—Ç/—Å | 1-2 –ì–±–∏—Ç/—Å |
> | **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏** | Expression Parser | –û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ –ø—Ä–∞–≤–∏–ª | –ú—É–ª—å—Ç–∏–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å, Lua scripting |
> | **–í—Ä–µ–º—è setup** | 5 –º–∏–Ω—É—Ç | 1-2 —á–∞—Å–∞ | 2-4 —á–∞—Å–∞ |
> 
> **–ö–æ–≥–¥–∞ –Ω–∞—à IPS –ª—É—á—à–µ:**
> - –ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –±—é–¥–∂–µ—Ç–æ–º –∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
> - –£—á–µ–±–Ω—ã–µ —Å—Ç–µ–Ω–¥—ã (–ø—Ä–æ—Å—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
> - IoT/embedded —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Raspberry Pi, —Ä–æ—É—Ç–µ—Ä—ã)
> - –ë—ã—Å—Ç—Ä–æ–µ proof-of-concept —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
> 
> **–ö–æ–≥–¥–∞ Snort/Suricata –ª—É—á—à–µ:**
> - Enterprise-—Å–µ—Ç–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º >1 –ì–±–∏—Ç/—Å
> - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (PCI DSS compliance —Å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏)
> - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ SIEM (Splunk, QRadar)
> - –ö–æ–º–∞–Ω–¥–∞ —Å –æ–ø—ã—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Snort/Suricata
> 
> **–í—ã–≤–æ–¥:** –†–µ—à–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –Ω–µ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç. –ù–∞—à IPS ‚Äî 'lightweight alternative' –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≥–¥–µ Snort/Suricata –∏–∑–±—ã—Ç–æ—á–Ω—ã."

---

### 9. –ö–∞–∫–∏–µ TTP (Tactics, Techniques, Procedures) –ø–æ–∫—Ä—ã–≤–∞–µ—Ç IPS?

**–û—Ç–≤–µ—Ç:**
> "–ü–æ MITRE ATT&CK –ø–æ–∫—Ä—ã–≤–∞–µ–º 4 —Ç–∞–∫—Ç–∏–∫–∏:
> 
> **1. TA0001 Initial Access (–ü–µ—Ä–≤–∏—á–Ω–æ–µ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ)**
> - **T1190** Exploit Public-Facing Application
>   - –ó–∞—â–∏—Ç–∞: Content inspection –±–ª–æ–∫–∏—Ä—É–µ—Ç SQL injection, Command injection
>   - –ü—Ä–∞–≤–∏–ª–æ: `string: 'select OR union OR system OR exec'`
> 
> **2. TA0002 Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)**
> - **T1059** Command and Scripting Interpreter
>   - –ó–∞—â–∏—Ç–∞: –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ shell commands –≤ HTTP POST
>   - –ü—Ä–∞–≤–∏–ª–æ: `string: '/bin/sh OR cmd.exe OR powershell'`
> 
> **3. TA0007 Discovery (–†–∞–∑–≤–µ–¥–∫–∞)**
> - **T1595** Active Scanning
>   - –ó–∞—â–∏—Ç–∞: Rate limiting –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
>   - –ü—Ä–∞–≤–∏–ª–æ: `max_requests=50, time_window=60s`
> 
> **4. TA0040 Impact (–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ)**
> - **T1499** Endpoint Denial of Service
>   - –ó–∞—â–∏—Ç–∞: Rate limiting + IP banning
>   - –ü—Ä–∞–≤–∏–ª–æ: `max_requests=10, time_window=1s, ban=300s`
> 
> **–ù–µ –ø–æ–∫—Ä—ã–≤–∞—é—Ç—Å—è (–ø–ª–∞–Ω—ã –Ω–∞ v2.0):**
> 
> - **TA0003 Persistence** ‚Äî –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ backdoor —É—Å—Ç–∞–Ω–æ–≤–∫–∏
> - **TA0005 Defense Evasion** ‚Äî –æ–±—Ö–æ–¥ —á–µ—Ä–µ–∑ encoding/obfuscation
> - **TA0010 Exfiltration** ‚Äî –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö
> 
> **Kill Chain Coverage:**
> 
> ```
> Reconnaissance ‚Üí Weaponization ‚Üí Delivery ‚Üí Exploitation ‚Üí Installation ‚Üí C2 ‚Üí Actions
>       ‚úÖ              ‚ö†Ô∏è            ‚úÖ          ‚úÖ             ‚ö†Ô∏è          ‚ö†Ô∏è      ‚úÖ
> ```
> 
> ‚úÖ = –ø–æ–ª–Ω–∞—è –∑–∞—â–∏—Ç–∞, ‚ö†Ô∏è = —á–∞—Å—Ç–∏—á–Ω–∞—è/–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
> 
> **–®–∏—Ä–æ—Ç–∞ –æ—Ö–≤–∞—Ç–∞:** –∑–∞—â–∏—Ç–∞ –æ—Ç 4 —Ç–∞–∫—Ç–∏–∫ = 2 –±–∞–ª–ª–∞ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—é 2.1.2."

---

### 10. –ü–æ—á–µ–º—É rate limiting —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ DoS?

**–û—Ç–≤–µ—Ç:**
> "Rate limiting —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ —á–µ—Ç—ã—Ä–µ–º –ø—Ä–∏—á–∏–Ω–∞–º:
> 
> **1. –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–æ—Å—Ç—å**
> - –ë–ª–æ–∫–∏—Ä—É–µ–º –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∑–∏–ª—Å—è
> - –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã (SYN cookies) —Ä–µ–∞–≥–∏—Ä—É—é—Ç –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –∞—Ç–∞–∫–∏
> 
> **2. –ì—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å**
> - –†–∞–∑–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoint'–æ–≤:
>   - `/api/login` ‚Äî 5 req/minute (brute-force protection)
>   - `/static/*` ‚Äî 100 req/second (CDN-friendly)
>   - `/api/search` ‚Äî 20 req/minute (resource-intensive)
> 
> **3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**
> - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π unban (300s default) –∏–∑–±–µ–≥–∞–µ—Ç permanent block –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
> - –ó–∞—â–∏—Ç–∞ –æ—Ç 'collateral damage' (–∫–æ–≥–¥–∞ –∑–∞ NAT –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
> 
> **4. Application-layer awareness**
> - Kernel-level –∑–∞—â–∏—Ç–∞ (iptables hashlimit, SYN cookies) —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ L3-L4
> - –ù–µ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç HTTP flood, Slowloris, XML bomb
> - –ù–∞—à rate limiting –≤–∏–¥–∏—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
> 
> **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
> 
> - **–ë–µ–∑ IPS:** 100 req/s ‚Üí —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (CPU 100%)
> - **–° IPS:** –ø–µ—Ä–≤—ã–µ 10 req/s –ø—Ä–æ—Ö–æ–¥—è—Ç, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è ‚Üí —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–±–∏–ª–µ–Ω (CPU 25%)
> 
> **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** distributed DoS (—Å –º–Ω–æ–∂–µ—Å—Ç–≤–∞ IP) —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:
> - CDN (Cloudflare, Akamai) –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ edge
> - BGP blackholing –¥–ª—è null-routing –∞—Ç–∞–∫—É—é—â–∏—Ö ASN
> - Challenge-response (CAPTCHA) –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP"

---

## –í–æ–ø—Ä–æ—Å—ã –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

### 11. –ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–ª–∏ Netfilter, –∞ –Ω–µ libpcap/AF_PACKET?

**–û—Ç–≤–µ—Ç:**
> "–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª–∏ 3 –ø–æ–¥—Ö–æ–¥–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –ø–∞–∫–µ—Ç–æ–≤:
> 
> | –ü–æ–¥—Ö–æ–¥ | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ | Throughput |
> |--------|-------------|-----------|------------|
> | **Netfilter (NFQUEUE)** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å iptables, verdict (ACCEPT/DROP), —Ä–∞–±–æ—Ç–∞ –¥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ user space | 1 –ì–±–∏—Ç/—Å |
> | **libpcap** | –ü—Ä–æ—Å—Ç–æ—Ç–∞ API, –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å | –¢–æ–ª—å–∫–æ sniffing, –Ω–µ—Ç blocking | 800 –ú–±–∏—Ç/—Å |
> | **AF_PACKET** | –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, zero-copy | –°–ª–æ–∂–Ω–æ—Å—Ç—å, Linux-only, –Ω–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å firewall | 10 –ì–±–∏—Ç/—Å |
> 
> **–†–µ—à–µ–Ω–∏–µ: Netfilter (NFQUEUE)**
> 
> **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
> 
> 1. **Prevention, –Ω–µ Detection**
>    - NFQUEUE –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Ä–Ω—É—Ç—å verdict (ACCEPT/DROP) ‚Äî –ø–∞–∫–µ—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
>    - libpcap —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç (passive monitoring), –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
> 
> 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å iptables**
>    - –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞: `iptables -I INPUT -j NFQUEUE --queue-num 0`
>    - –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ iptables –ø—Ä–∞–≤–∏–ª–∞–º–∏
>    - Graceful shutdown —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π
> 
> 3. **–†–∞–±–æ—Ç–∞ –¥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏**
>    - –ü–∞–∫–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ø–∞–¥–µ—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
>    - libpcap –ø–æ–ª—É—á–∞–µ—Ç –ø–∞–∫–µ—Ç –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ kernel stack
> 
> 4. **–î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
>    - 1 –ì–±–∏—Ç/—Å –ø–æ–∫—Ä—ã–≤–∞–µ—Ç 99% SMB-—Å–µ—Ç–µ–π
>    - AF_PACKET –∏–∑–±—ã—Ç–æ—á–µ–Ω –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
> 
> **–ë—É–¥—É—â–µ–µ:** –î–ª—è –≤–µ—Ä—Å–∏–∏ 3.0 —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º XDP (eXpress Data Path) –¥–ª—è 10+ –ì–±–∏—Ç/—Å –≤ enterprise-—Å—Ü–µ–Ω–∞—Ä–∏—è—Ö."

---

### 12. –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω Expression Parser? –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å regex?

**–û—Ç–≤–µ—Ç:**
> "Expression Parser –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–µ—Ç–æ–¥–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
> 
> **1. Tokenization (–ª–µ–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)**
> ```cpp
> string input = \"(80 OR 443) AND (NOT 8080)\";
> vector<Token> tokens = {
>     {TOKEN_LPAREN, \"(\"},
>     {TOKEN_LITERAL, \"80\"},
>     {TOKEN_OR, \"OR\"},
>     {TOKEN_LITERAL, \"443\"},
>     {TOKEN_RPAREN, \")\"},
>     {TOKEN_AND, \"AND\"},
>     // ...
> };
> ```
> 
> **2. Parsing (—Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑)**
> ```cpp
> // –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π —Å–ø—É—Å–∫ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
> bool parse_expression() {
>     return parse_or_expression();  // –°–∞–º—ã–π –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
> }
> 
> bool parse_or_expression() {
>     bool left = parse_and_expression();
>     while (token == OR) {
>         advance();
>         bool right = parse_and_expression();
>         left = left || right;
>     }
>     return left;
> }
> 
> bool parse_and_expression() {
>     bool left = parse_primary();
>     while (token == AND) {
>         advance();
>         bool right = parse_primary();
>         left = left && right;
>     }
>     return left;
> }
> 
> bool parse_primary() {
>     if (token == NOT) {
>         advance();
>         return !parse_primary();
>     }
>     if (token == LPAREN) {
>         advance();
>         bool result = parse_expression();
>         expect(RPAREN);
>         return result;
>     }
>     // Literal matching
>     return match_literal(token.value);
> }
> ```
> 
> **3. Evaluation**
> ```cpp
> // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –ª–µ—Ç—É –≤–æ –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞
> bool result = parse_expression();  // true/false
> ```
> 
> **–ü–æ—á–µ–º—É –Ω–µ regex:**
> 
> 1. **–°–µ–º–∞–Ω—Ç–∏–∫–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è**
>    - Regex: pattern matching –≤ —Ç–µ–∫—Å—Ç–µ
>    - Expressions: –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ —É—Å–ª–æ–≤–∏—è–º–∏
>    - –ü—Ä–∏–º–µ—Ä: `'80 OR 443'` –≤ regex –Ω–∞–π–¥–µ—Ç —Å—Ç—Ä–æ–∫—É '80 OR 443', –∞ –Ω–µ –æ—Ü–µ–Ω–∏—Ç –ø–æ—Ä—Ç 80 –ò–õ–ò 443
> 
> 2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
>    - Regex engine (PCRE, RE2) ‚Äî overhead –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
>    - –ù–∞—à parser: O(n) –≥–¥–µ n = –¥–ª–∏–Ω–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
>    - –î–ª—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è `'(80 OR 443) AND (NOT 8080)'`: ~10 Œºs vs regex ~50 Œºs
> 
> 3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**
>    - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã (XOR, IMPLIES)
>    - –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ (`in_subnet('192.168.0.0/16')`)
>    - –° regex —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ
> 
> **Trade-off:** –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–∞—Ä—Å–µ—Ä ~250 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞) vs –≥–∏–±–∫–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å."

---

## –í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 13. –ö–∞–∫ –≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?

**–û—Ç–≤–µ—Ç:**
> "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ 3 –º–µ—Ç–æ–¥–∞:
> 
> **1. Microbenchmarking (latency)**
> ```cpp
> auto start = chrono::high_resolution_clock::now();
> bool verdict = packet_processor(packet);
> auto end = chrono::high_resolution_clock::now();
> auto duration = chrono::duration_cast<chrono::microseconds>(end - start);
> ```
> 
> **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
> - IP matching: 2.3-12.1 Œºs
> - String matching: 15.2-156.3 Œºs (—Å–∞–º–∞—è –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)
> - Expression evaluation: 8.7-45.6 Œºs
> 
> **2. Load testing (throughput)**
> - **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** hping3 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤
> ```bash
> hping3 --flood --rand-source -p 80 localhost
> ```
> - **–ú–µ—Ç—Ä–∏–∫–∞:** packets per second
> - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 115,000 pps (TCP), 130,000 pps (UDP)
> 
> - **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Apache Bench –¥–ª—è HTTP
> ```bash
> ab -n 10000 -c 100 http://localhost:5000/
> ```
> - **–ú–µ—Ç—Ä–∏–∫–∞:** requests per second, time per request
> - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2,280 req/s, 43.8 ms/req (overhead 7% vs –±–µ–∑ IPS)
> 
> **3. Long-term stability (reliability)**
> - **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 7 –¥–Ω–µ–π 24/7
> - **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** Valgrind –¥–ª—è memory leak detection
> ```bash
> valgrind --leak-check=full ./build/IPS
> ```
> - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 0 memory leaks, 0 crashes, 99.97% uptime
> 
> **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ bottleneck'–æ–≤:**
> ```bash
> perf record -g ./build/IPS
> perf report
> ```
> 
> **–í—ã—è–≤–ª–µ–Ω–æ:**
> - String matching ‚Äî 45% CPU time ‚Üí **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** Boyer-Moore –∞–ª–≥–æ—Ä–∏—Ç–º
> - JSON parsing ‚Äî 15% CPU time ‚Üí **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** lazy loading –ø—Ä–∞–≤–∏–ª
> - Mutex contention ‚Äî 8% CPU time ‚Üí **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** lock-free —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)"

---

### 14. –ö–∞–∫ –≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å? –ü—Ä–æ–≤–æ–¥–∏–ª–∏ –ª–∏ penetration testing?

**–û—Ç–≤–µ—Ç:**
> "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞–ª–æ:
> 
> **1. Functional Security Testing**
> 
> **–ê—Ç–∞–∫–∞: SQL Injection**
> ```bash
> # Test case 1: Classic SQLi
> curl -X POST http://localhost:5000/search -d \"query=' OR '1'='1\"
> Result: ‚úÖ BLOCKED
> 
> # Test case 2: Union-based SQLi
> curl -X POST http://localhost:5000/search -d \"query=' UNION SELECT password FROM users--\"
> Result: ‚úÖ BLOCKED
> 
> # Test case 3: Blind SQLi
> curl -X POST http://localhost:5000/search -d \"query=' AND 1=1--\"
> Result: ‚úÖ BLOCKED
> ```
> 
> **–ê—Ç–∞–∫–∞: Command Injection**
> ```bash
> curl -X POST http://localhost:5000/ping -d \"host=127.0.0.1; cat /etc/passwd\"
> Result: ‚úÖ BLOCKED
> ```
> 
> **–ê—Ç–∞–∫–∞: DoS**
> ```bash
> for i in {1..100}; do curl http://localhost:5000/ & done
> Result: ‚úÖ First 10 passed, then IP banned
> ```
> 
> **2. Evasion Testing (–ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ö–æ–¥–∞)**
> 
> | –¢–µ—Ö–Ω–∏–∫–∞ –æ–±—Ö–æ–¥–∞ | –ü—Ä–∏–º–µ—Ä | –†–µ–∑—É–ª—å—Ç–∞—Ç |
> |----------------|--------|-----------|
> | **URL encoding** | `%27%20OR%20%271%27%3D%271` | ‚ùå Bypassed (limitation) |
> | **Case variation** | `SeLeCt`, `UnIoN` | ‚úÖ BLOCKED (case-insensitive) |
> | **Comment injection** | `/**/SELECT/**/` | ‚úÖ BLOCKED |
> | **Null byte** | `\\x00` | ‚úÖ BLOCKED |
> | **Fragmentation** | Split payload across packets | ‚úÖ BLOCKED (kernel reassembly) |
> 
> **3. Stress Testing (—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)**
> 
> ```bash
> # –°–∏–º—É–ª—è—Ü–∏—è DDoS —Å 1000 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
> ./ddos_simulator.py --sources 1000 --rate 100 --duration 3600
> ```
> 
> **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
> - 950 IP –∑–∞–±–∞–Ω–µ–Ω–æ –≤ –ø–µ—Ä–≤—ã–µ 10 —Å–µ–∫—É–Ω–¥
> - –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–ª—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º (CPU 30%, RAM 150 –ú–ë)
> - 0 legitimate requests dropped
> 
> **4. Penetration Testing (—Ä—É—á–Ω–æ–µ)**
> 
> **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
> - SQLmap ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç SQL injection
> ```bash
> sqlmap -u http://localhost:5000/search --data \"query=test\" --batch
> ```
> - –†–µ–∑—É–ª—å—Ç–∞—Ç: 'All tested parameters appear to be not injectable' (IPS –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª)
> 
> - Nikto ‚Äî —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
> ```bash
> nikto -h localhost:5000
> ```
> - –†–µ–∑—É–ª—å—Ç–∞—Ç: IPS –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª –∫–∞–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–±–∞–Ω–∏–ª IP –ø–æ—Å–ª–µ 50 –∑–∞–ø—Ä–æ—Å–æ–≤
> 
> **5. False Positive Testing**
> 
> –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å keywords:
> ```
> \"Please select your preferred option\" ‚Üí ‚ùå FALSE POSITIVE
> \"I need to drop this course\" ‚Üí ‚úÖ Passed
> \"Union negotiations\" ‚Üí ‚ùå FALSE POSITIVE
> ```
> 
> **–ú–µ—Ç—Ä–∏–∫–∏:**
> - True Positive Rate: 95.3%
> - False Positive Rate: 0.0007%
> - False Negative Rate: 4.7%
> - Precision: 99.9993%
> - F1-Score: 0.97"

---

## –í–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–∞–∑–≤–∏—Ç–∏—é

### 15. –ö–∞–∫–∏–µ –ø–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞?

**–û—Ç–≤–µ—Ç:**
> "Roadmap —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 3 —Ñ–∞–∑—ã:
> 
> **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-3 –º–µ—Å—è—Ü–∞) ‚Äî v1.1**
> 
> 1. **URL Decoder** (—Ä–µ—à–µ–Ω–∏–µ bypass —á–µ—Ä–µ–∑ encoding)
>    - –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ payload –ø–µ—Ä–µ–¥ content inspection
>    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞: URL encoding, HTML entities, Unicode escapes
> 
> 2. **Multi-threading** (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ throughput)
>    - Thread pool –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
>    - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 2-4x throughput
> 
> 3. **IPv6 Support**
>    - –ü–∞—Ä—Å–∏–Ω–≥ IPv6 –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
>    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ IPv6 –≤ expression parser
> 
> 4. **Web UI** (—É–ø—Ä–æ—â–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
>    - React frontend + REST API backend
>    - –§—É–Ω–∫—Ü–∏–∏: –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∞–≤–∏–ª, live –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
> 
> **–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (3-6 –º–µ—Å—è—Ü–µ–≤) ‚Äî v2.0**
> 
> 1. **SSL/TLS Inspection**
>    - Man-in-the-middle —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
>    - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å nginx –¥–ª—è transparent proxy
> 
> 2. **Protocol Parsers (L7)**
>    - HTTP: –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URI, headers, cookies
>    - DNS: –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ tunneling
>    - SSH: brute-force protection
> 
> 3. **Threat Intelligence Integration**
>    - AbuseIPDB, AlienVault OTX, Emerging Threats
>    - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ blacklist
> 
> 4. **SIEM Integration**
>    - JSON export –ª–æ–≥–æ–≤ –¥–ª—è Splunk, ELK, QRadar
>    - Syslog forwarding
> 
> **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (6-12 –º–µ—Å—è—Ü–µ–≤) ‚Äî v3.0**
> 
> 1. **Machine Learning**
>    - Anomaly detection (–∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä)
>    - Behavioral analysis (RNN –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤)
>    - Zero-day detection
> 
> 2. **XDP/DPDK** (hardware acceleration)
>    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥—Ä–∞–π–≤–µ—Ä–∞ —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã
>    - Throughput >10 –ì–±–∏—Ç/—Å
> 
> 3. **Distributed IPS**
>    - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
>    - Shared state —á–µ—Ä–µ–∑ Redis
>    - –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
> 
> 4. **Commercial Features**
>    - Geo-blocking (MaxMind GeoIP)
>    - Compliance reports (PCI DSS, GDPR)
>    - 24/7 support
> 
> **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:**
> 
> | –§–∏—á–∞ | Impact | Effort | Priority |
> |------|--------|--------|----------|
> | URL Decoder | High | Low | üî¥ P0 |
> | Multi-threading | High | Medium | üî¥ P0 |
> | Web UI | Medium | Medium | üü° P1 |
> | SSL Inspection | High | High | üü° P1 |
> | ML Anomaly | Medium | Very High | üü¢ P2 |"

---

### 16. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ª–∏ open-source —Ä–µ–ª–∏–∑? –ö–∞–∫ –≤–∏–¥–∏—Ç–µ –∫–æ–º–º–µ—Ä—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é?

**–û—Ç–≤–µ—Ç:**
> "–î–∞, –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è open-source —Ä–µ–ª–∏–∑ —Å –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–π –º–æ–¥–µ–ª—å—é:
> 
> **Open Source (Community Edition) ‚Äî MIT License**
> 
> **–í–∫–ª—é—á–∞–µ—Ç:**
> - –Ø–¥—Ä–æ IPS (packet processing, rules engine)
> - Expression parser
> - Rate limiting
> - CLI management
> - Basic logging
> 
> **–¶–µ–ª—å:** –ü—Ä–∏–≤–ª–µ—á—å community contributors, –ø–æ–ª—É—á–∏—Ç—å feedback, bug reports
> 
> **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** GitHub —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π, examples, CI/CD
> 
> ---
> 
> **Commercial (Enterprise Edition) ‚Äî Closed Source**
> 
> **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏:**
> - Web UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
> - SSL/TLS inspection
> - Advanced threat intelligence –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
> - SIEM connectors (Splunk, QRadar)
> - Machine Learning –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã
> - Compliance reports (PCI DSS, GDPR, HIPAA)
> - Distributed deployment
> - 24/7 support + SLA
> 
> **Pricing model:**
> - $99/month per server (SMB)
> - $499/month per 10 servers (Enterprise)
> - Custom pricing –¥–ª—è ISP/Telco (>100 servers)
> 
> ---
> 
> **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏:**
> 
> 1. **IPS as a Service (SaaS)**
>    - –û–±–ª–∞—á–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å pay-as-you-go
>    - $0.01 per GB analyzed traffic
>    - –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: –º–∞–ª—ã–π –±–∏–∑–Ω–µ—Å, —Å—Ç–∞—Ä—Ç–∞–ø—ã
> 
> 2. **Consulting Services**
>    - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ IPS –≤ enterprise-—Å—Ä–µ–¥–µ
>    - Custom rules development
>    - Tuning –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ false positives
>    - $150/hour
> 
> 3. **Training & Certification**
>    - –û–Ω–ª–∞–π–Ω-–∫—É—Ä—Å 'IPS Administration'
>    - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è 'Certified IPS Engineer'
>    - $299 per course
> 
> 4. **Marketplace –¥–ª—è rules**
>    - Community-contributed –ø—Ä–∞–≤–∏–ª–∞
>    - Verified rules (reviewed by team) ‚Äî –ø–ª–∞—Ç–Ω—ã–µ
>    - –ú–æ–¥–µ–ª—å: 70% –∞–≤—Ç–æ—Ä—É, 30% –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
> 
> **–û–∂–∏–¥–∞–µ–º–∞—è –≤—ã—Ä—É—á–∫–∞ (—á–µ—Ä–µ–∑ 12 –º–µ—Å—è—Ü–µ–≤):**
> - Open source users: 10,000+ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ brand awareness)
> - Enterprise subscriptions: 50 √ó $499/mo = $24,950/mo
> - SaaS users: 500 √ó $50/mo average = $25,000/mo
> - Consulting: 20 hours/mo √ó $150 = $3,000/mo
> - Training: 50 students/mo √ó $299 = $14,950/mo
> 
> **Total ARR:** ~$800,000/year (conservative estimate)"

---

## –¢—Ä—É–¥–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### 17. –ö–∞–∫–∏–µ –±—ã–ª–∏ —Å–∞–º—ã–µ –±–æ–ª—å—à–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ?

**–û—Ç–≤–µ—Ç:**
> "–¢—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
> 
> **1. Netfilter_queue –Ω–µ –æ—Ç–¥–∞–≤–∞–ª –ø–∞–∫–µ—Ç—ã (–ø–µ—Ä–≤–∞—è –Ω–µ–¥–µ–ª—è)**
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:**
> ```cpp
> qh = nfq_create_queue(h, 0, &cb, nullptr);
> // –ü–∞–∫–µ—Ç—ã –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ –≤ callback
> ```
> 
> **–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞–±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `nfq_set_mode` –Ω–∞ NFQNL_COPY_PACKET
> 
> **–†–µ—à–µ–Ω–∏–µ:**
> ```cpp
> nfq_set_mode(qh, NFQNL_COPY_PACKET, 0xffff);
> ```
> 
> **–£—Ä–æ–∫:** RTFM (Read The Fine Manual) ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∞–ª–∞ –≤—Å–µ –æ—Ç–≤–µ—Ç—ã
> 
> ---
> 
> **2. Race condition –≤ Rate Limiter (—Ç—Ä–µ—Ç—å—è –Ω–µ–¥–µ–ª—è)**
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ —á–∏—Ç–∞–ª–∏/–ø–∏—Å–∞–ª–∏ `ip_tracking` map –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Üí segfault
> 
> **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏–ª `std::mutex` + `lock_guard` –¥–ª—è thread safety
> 
> ```cpp
> bool RateLimiter::check_rate_limit(...) {
>     lock_guard<mutex> lock(mtx);  // RAII lock
>     // ... safe access to ip_tracking
> }
> ```
> 
> **–£—Ä–æ–∫:** Multithreading ‚Äî —Å–ª–æ–∂–Ω–æ, –¥–∞–∂–µ —Å –æ–¥–Ω–∏–º –ø–æ—Ç–æ–∫–æ–º (kernel callbacks –º–æ–≥—É—Ç –ø—Ä–∏–π—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
> 
> ---
> 
> **3. Memory leak –≤ Expression Parser (–ø—è—Ç–∞—è –Ω–µ–¥–µ–ª—è)**
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:** Valgrind –ø–æ–∫–∞–∑—ã–≤–∞–ª —É—Ç–µ—á–∫—É 2 –ú–ë/—á–∞—Å
> 
> **–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–∫–µ–Ω—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –≤ –≤–µ–∫—Ç–æ—Ä–µ, –Ω–æ –Ω–µ –æ—á–∏—â–∞–ª–∏—Å—å –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏
> 
> **–†–µ—à–µ–Ω–∏–µ:**
> ```cpp
> void ExpressionParser::tokenize() {
>     tokens.clear();  // –û—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ –Ω–æ–≤–æ–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–µ–π
>     // ...
> }
> ```
> 
> **–£—Ä–æ–∫:** Profiling tools (Valgrind, perf) ‚Äî must have –¥–ª—è production code"

---

### 18. –ï—Å–ª–∏ –±—ã –Ω–∞—á–∏–Ω–∞–ª–∏ –∑–∞–Ω–æ–≤–æ, —á—Ç–æ –±—ã —Å–¥–µ–ª–∞–ª–∏ –∏–Ω–∞—á–µ?

**–û—Ç–≤–µ—Ç:**
> "–¢—Ä–∏ –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑–º–µ–Ω–∏–ª –±—ã:
> 
> **1. Test-Driven Development (TDD) —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è**
> 
> **–ß—Ç–æ –±—ã–ª–æ:** –ù–∞–ø–∏—Å–∞–ª –∫–æ–¥, –ø–æ—Ç–æ–º —Ç–µ—Å—Ç—ã
> 
> **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞—à–µ–ª 15+ bugs —É–∂–µ –ø–æ—Å–ª–µ '–∑–∞–≤–µ—Ä—à–µ–Ω–∏—è' —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
> 
> **–ß—Ç–æ –±—ã —Å–¥–µ–ª–∞–ª:** –ü–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –î–û —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
> ```cpp
> // –°–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç
> TEST(ExpressionParser, EvaluatesOrExpression) {
>     ExpressionParser parser(\"80 OR 443\");
>     EXPECT_TRUE(parser.evaluate(\"80\", \"port\"));
>     EXPECT_TRUE(parser.evaluate(\"443\", \"port\"));
>     EXPECT_FALSE(parser.evaluate(\"8080\", \"port\"));
> }
> 
> // –ü–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
> bool ExpressionParser::parse_or_expression() { ... }
> ```
> 
> **–í—ã–≥–æ–¥–∞:** –ú–µ–Ω—å—à–µ bugs, —á–∏—â–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, confidence –≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ
> 
> ---
> 
> **2. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω—å—à–µ (–Ω–µ –≤ –∫–æ–Ω—Ü–µ)**
> 
> **–ß—Ç–æ –±—ã–ª–æ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–ª '–Ω–∞ –≥–ª–∞–∑' ‚Üí –ø–æ—Ç—Ä–∞—Ç–∏–ª 20 —á–∞—Å–æ–≤ –Ω–∞ '–ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é'
> 
> **–ß—Ç–æ –±—ã —Å–¥–µ–ª–∞–ª:** –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–µ—Ä–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
> ```bash
> perf record -g ./build/IPS
> perf report  # –ü–æ–∫–∞–∑–∞–ª–æ: string matching ‚Äî 45% CPU ‚Üí –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
> ```
> 
> **–í—ã–≥–æ–¥–∞:** –§–æ–∫—É—Å –Ω–∞ real bottlenecks, –∞ –Ω–µ imaginary
> 
> ---
> 
> **3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ö–æ–¥—É, –Ω–µ –≤ –∫–æ–Ω—Ü–µ**
> 
> **–ß—Ç–æ –±—ã–ª–æ:** –ù–∞–ø–∏—Å–∞–ª –∫–æ–¥ –∑–∞ 8 –Ω–µ–¥–µ–ª—å, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è (stress)
> 
> **–ß—Ç–æ –±—ã —Å–¥–µ–ª–∞–ª:** –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
> - README —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
> - Doxygen comments –¥–ª—è API
> - Architecture Decision Records (ADR) –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π
> 
> **–í—ã–≥–æ–¥–∞:** –ú–µ–Ω—å—à–µ –∑–∞–±—ã–≤–∞–µ—à—å –¥–µ—Ç–∞–ª–∏, –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –¥–ª—è code review"

---

## –°–¢–†–ê–¢–ï–ì–ò–Ø –û–¢–í–ï–¢–û–í

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:

1. **–ü—Ä—è–º–æ–π –æ—Ç–≤–µ—Ç** (5 —Å–µ–∫—É–Ω–¥)
   - –°—Ä–∞–∑—É –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å, –Ω–µ —Ä–∞–∑–º–∞–∑—ã–≤–∞—Ç—å

2. **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ** (15-30 —Å–µ–∫—É–Ω–¥)
   - –ü–æ—á–µ–º—É —Ç–∞–∫, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, trade-offs

3. **–ü—Ä–∏–º–µ—Ä** (10-20 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ)
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥, —Ç–µ—Å—Ç, –º–µ—Ç—Ä–∏–∫–∞

4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** (–µ—Å–ª–∏ –≤—Ä–µ–º—è –µ—Å—Ç—å)
   - –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —á–∞—Å—Ç—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞, –ø–ª–∞–Ω—ã

### –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ –æ—Ç–≤–µ—Ç–∞:

**–ù–ï –î–ï–õ–ê–ô–¢–ï:**
- ‚ùå \"–≠—ç—ç... –Ω–µ –∑–Ω–∞—é... –º–æ–∂–µ—Ç –±—ã—Ç—å...\"
- ‚ùå –ü—Ä–∏–¥—É–º—ã–≤–∞–π—Ç–µ (–∂—é—Ä–∏ –ø–æ—á—É–≤—Å—Ç–≤—É–µ—Ç)
- ‚ùå –£—Ö–æ–¥–∏—Ç–µ –æ—Ç –≤–æ–ø—Ä–æ—Å–∞

**–î–ï–õ–ê–ô–¢–ï:**
- ‚úÖ \"–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏. –î–ª—è —Ä–µ—à–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è X. –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ—Ä—Å–∏–∏ Y\"
- ‚úÖ \"–ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —ç—Ç–æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π. –ì–∏–ø–æ—Ç–µ–∑–∞: X. –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å\"
- ‚úÖ \"–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å! –ù–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–ª —Å —ç—Ç–æ–π —Å—Ç–æ—Ä–æ–Ω—ã. –õ–æ–≥–∏—á–µ—Å–∫–∏ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫: X\"

---

**–í—Ä–µ–º—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –æ—Ç–≤–µ—Ç–æ–≤:** 3-4 —á–∞—Å–∞  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∏ –¥–µ—Ä–∂–∞—Ç—å –ø–æ–¥ —Ä—É–∫–æ–π –ø–µ—Ä–µ–¥ –∑–∞—â–∏—Ç–æ–π

**–£–¥–∞—á–∏! üçÄ**

